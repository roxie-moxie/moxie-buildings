---
milestone: v1.0
audited: 2026-02-21T23:00:00Z
status: gaps_found
scores:
  requirements: 20/26
  phases: 6/6 (completed phases pass; Phase 5 never started)
  integration: 3/4 flows verified
  flows: 3/5 E2E flows complete
gaps:
  requirements:
    - id: "AGENT-02"
      status: "orphaned"
      phase: "Phase 5 (Frontend)"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Phase 5 has no directory, no plans, no VERIFICATION.md. Requirement never started."
    - id: "AGENT-03"
      status: "orphaned"
      phase: "Phase 5 (Frontend)"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Phase 5 has no directory, no plans, no VERIFICATION.md. Requirement never started."
    - id: "AGENT-04"
      status: "orphaned"
      phase: "Phase 5 (Frontend)"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Phase 5 has no directory, no plans, no VERIFICATION.md. Requirement never started."
    - id: "AGENT-05"
      status: "orphaned"
      phase: "Phase 5 (Frontend)"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Phase 5 has no directory, no plans, no VERIFICATION.md. Requirement never started."
    - id: "AGENT-06"
      status: "orphaned"
      phase: "Phase 5 (Frontend)"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Phase 5 has no directory, no plans, no VERIFICATION.md. No sort_by parameter exists on /units API either."
    - id: "AGENT-07"
      status: "orphaned"
      phase: "Phase 5 (Frontend)"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "orphaned"
      evidence: "Phase 5 has no directory, no plans, no VERIFICATION.md. API returns last_scraped field but no frontend to display it."
  integration:
    - from: "Phase 7 (KNOWN_PLATFORMS)"
      to: "Phase 2 (PLATFORM_PATTERNS)"
      issue: "sightmap added to KNOWN_PLATFORMS but not to PLATFORM_PATTERNS -- sheets_sync auto-detection cannot classify sightmap buildings"
      affected_reqs: ["INFRA-01"]
    - from: "Phase 4 (admin re-scrape)"
      to: "Phase 3 (runner)"
      issue: "needs_classification platform value causes KeyError in PLATFORM_SCRAPERS during re-scrape -- silent failure instead of meaningful error"
      affected_reqs: ["ADMIN-04"]
  flows:
    - flow: "Sheets sync to sightmap auto-detection"
      breaks_at: "detect_platform() has no sightmap.com pattern"
      affected_reqs: ["INFRA-01"]
    - flow: "Admin re-scrape on unclassified building"
      breaks_at: "needs_classification passed to PLATFORM_SCRAPERS raises KeyError"
      affected_reqs: ["ADMIN-04"]
tech_debt:
  - phase: 01-foundation
    items:
      - "Info: .env.example contains real Google Sheet ID instead of placeholder string"
  - phase: 02-scrapers
    items:
      - "Warning: CSS selectors in Tier 2 scrapers (funnel, appfolio, bozzuto, realpage, groupfox) are heuristic and unverified against live pages"
      - "Info: LLM benchmark token cost uses estimated output JSON length, not actual API usage headers"
      - "Warning: No post-scrape bed type audit query was ever run against the live database"
  - phase: 03-scheduler
    items:
      - "Info: APScheduler 2 AM cron never confirmed via overnight wall-clock run (human_needed)"
      - "Info: ROADMAP.md line 77 still shows 03-02-PLAN.md as unchecked despite completion"
  - phase: 04-api-layer
    items:
      - "Info: Default SECRET_KEY is change-me-in-production (23 bytes, PyJWT warns on short HMAC key)"
      - "Info: create-admin CLI not registered as .exe script (uv sync blocked by locked process)"
  - phase: 06-fix-data-pipeline-bugs
    items:
      - "Info: Stale docstring in units.py still mentions Available Now special handling"
      - "Warning: Runner success path duplicates save_scrape_result logic inline instead of delegating -- maintenance divergence risk"
  - phase: 07-scraper-code-test-cleanup
    items:
      - "Info: floor_plan_url stored in DB but not returned by /units API UnitOut schema"
---

# v1.0 Milestone Audit Report

**Milestone:** v1.0
**Audited:** 2026-02-21
**Status:** GAPS FOUND
**Score:** 20/26 requirements satisfied

---

## Executive Summary

The v1.0 milestone has **6 unsatisfied requirements** -- all from Phase 5 (Frontend), which was never started. Phases 1-4, 6, and 7 are all complete with verified phase goals. The backend is fully functional: scrapers cover 306/407 buildings, the scheduler runs daily batches, and the API exposes authenticated search, admin, and re-scrape endpoints.

The 6 missing requirements (AGENT-02 through AGENT-07) are the agent-facing frontend: bed type/rent/date/neighborhood filters in the UI, column sorting, and data freshness indicators. The API layer already implements the filter parameters (except sort) -- only the browser UI is missing.

---

## Requirements Coverage (3-Source Cross-Reference)

| REQ-ID | Description | Phase | VERIFICATION.md | REQUIREMENTS.md | Final Status |
|--------|-------------|-------|-----------------|-----------------|--------------|
| INFRA-01 | Sheets sync to DB | Phase 1 | SATISFIED | [x] Complete | **satisfied** |
| INFRA-02 | Daily scheduled scraping | Phase 3 | SATISFIED (code) | [x] Complete | **satisfied** |
| INFRA-03 | Retain data on failure | Phase 6 | SATISFIED | [x] Complete | **satisfied** |
| DATA-01 | Required unit fields | Phase 1 | SATISFIED | [x] Complete | **satisfied** |
| DATA-02 | Optional unit fields | Phase 1 | SATISFIED | [x] Complete | **satisfied** |
| DATA-03 | Normalized canonical format | Phase 1 | SATISFIED | [x] Complete | **satisfied** |
| SCRAP-01 | RentCafe via SecureCafe | Phase 7 | SATISFIED | [x] Complete | **satisfied** |
| SCRAP-02 | Entrata via LLM | Phase 2 | SATISFIED | [x] Complete | **satisfied** |
| SCRAP-03 | PPM scraping | Phase 2 | SATISFIED | [x] Complete | **satisfied** |
| SCRAP-04 | Funnel scraping | Phase 2 | SATISFIED | [x] Complete | **satisfied** |
| SCRAP-05 | RealPage scraping | Phase 2 | SATISFIED | [x] Complete | **satisfied** |
| SCRAP-06 | Bozzuto scraping | Phase 2 | SATISFIED | [x] Complete | **satisfied** |
| SCRAP-07 | Groupfox scraping | Phase 2 | SATISFIED | [x] Complete | **satisfied** |
| SCRAP-08 | AppFolio scraping | Phase 2 | SATISFIED | [x] Complete | **satisfied** |
| SCRAP-09 | LLM fallback scraping | Phase 2 | SATISFIED | [x] Complete | **satisfied** |
| AGENT-01 | Agent login | Phase 4/6 | SATISFIED | [x] Complete | **satisfied** |
| AGENT-02 | Filter by bed type (UI) | Phase 5 | **orphaned** | [ ] Pending | **unsatisfied** |
| AGENT-03 | Filter by rent range (UI) | Phase 5 | **orphaned** | [ ] Pending | **unsatisfied** |
| AGENT-04 | Filter by availability date (UI) | Phase 5 | **orphaned** | [ ] Pending | **unsatisfied** |
| AGENT-05 | Filter by neighborhood (UI) | Phase 5 | **orphaned** | [ ] Pending | **unsatisfied** |
| AGENT-06 | Sort results (UI) | Phase 5 | **orphaned** | [ ] Pending | **unsatisfied** |
| AGENT-07 | Data freshness indicator (UI) | Phase 5 | **orphaned** | [ ] Pending | **unsatisfied** |
| ADMIN-01 | Create agent accounts | Phase 4 | SATISFIED | [x] Complete | **satisfied** |
| ADMIN-02 | Deactivate agent accounts | Phase 4 | SATISFIED | [x] Complete | **satisfied** |
| ADMIN-03 | View building list | Phase 4 | SATISFIED | [x] Complete | **satisfied** |
| ADMIN-04 | Trigger re-scrape | Phase 4 | SATISFIED | [x] Complete | **satisfied** |

**Note on SUMMARY frontmatter:** No SUMMARY.md files in this project contain a `requirements_completed` field. Cross-reference was performed using VERIFICATION.md and REQUIREMENTS.md traceability table (2 of 3 sources).

---

## Phase Verification Summary

| Phase | Status | Score | Key Notes |
|-------|--------|-------|-----------|
| 01 Foundation | PASSED | 5/5 | All artifacts verified, human checkpoint passed |
| 02 Scrapers | gaps_found | 3/5 | Original gaps (RentCafe stub, bed type audit) resolved by Phases 6-7 |
| 03 Scheduler | human_needed | 9/10 | Code verified; overnight 2 AM cron run pending human confirmation |
| 04 API Layer | PASSED | 30/30 | Full test suite, all endpoints verified |
| 05 Frontend | **NOT STARTED** | 0/0 | No phase directory, no plans, no code |
| 06 Fix Data Pipeline | PASSED | 4/4 | Both audit bugs fixed with regression tests |
| 07 Scraper Cleanup | PASSED | 3/3 | Dead code removed, 283 tests pass clean |

---

## Cross-Phase Integration Results

### Verified E2E Flows

1. **Sheets sync -> scraper dispatch -> units in DB -> API query** -- WIRED for all classified platforms. `sheets_sync()` -> `Building` upsert -> `detect_platform()` -> `PLATFORM_SCRAPERS` registry -> `scrape()` -> `save_scrape_result()` -> `normalize()` -> `Unit` insert -> `/units` API with filters.

2. **Admin -> user -> login -> search** -- WIRED. `POST /admin/users` -> User insert -> `POST /auth/login` -> JWT -> `GET /units` with auth -> filtered results with `last_scraped` freshness field.

3. **Scraper failure -> data retention -> stale marking** -- WIRED. Exception in scraper -> `save_scrape_result(scrape_succeeded=False)` -> units retained -> `last_scrape_status='failed'` -> visible via `/admin/buildings`.

### Partial/Broken Flows

4. **Sheets sync -> sightmap auto-detection** -- BROKEN at `detect_platform()`. `sightmap` is in `KNOWN_PLATFORMS` (Phase 7) but no `("sightmap", "sightmap.com")` pattern exists in `PLATFORM_PATTERNS`. The 54 SightMap buildings require manual platform assignment in Google Sheets. Workaround: Sheet "Platform" column set manually. Affects INFRA-01.

5. **Admin re-scrape on unclassified building** -- BROKEN. `building.platform = "needs_classification"` passes truthy to `PLATFORM_SCRAPERS[platform]` -> `KeyError`. Silent failure, not a user-friendly error. Affects ADMIN-04.

### Data Contract

All normalizer output fields are correctly wired through DB to API schema, with one minor gap: `floor_plan_url` is stored in the DB but not exposed in `UnitOut` API schema (affects DATA-02 at the API boundary only -- the field IS stored as required).

---

## Unsatisfied Requirements Detail

All 6 unsatisfied requirements are assigned to **Phase 5 (Frontend)**, which has no phase directory, no plans, and no code.

| REQ-ID | Description | API Backend | Missing |
|--------|-------------|-------------|---------|
| AGENT-02 | Filter by bed type | `GET /units?beds=` implemented | Browser UI |
| AGENT-03 | Filter by rent range | `GET /units?rent_min=&rent_max=` implemented | Browser UI |
| AGENT-04 | Filter by availability date | `GET /units?available_before=` implemented | Browser UI |
| AGENT-05 | Filter by neighborhood | `GET /units?neighborhood=` implemented | Browser UI |
| AGENT-06 | Sort results | **No `sort_by` parameter on /units** | API parameter + Browser UI |
| AGENT-07 | Data freshness indicator | `UnitOut.last_scraped` field exists | Browser UI |

---

## Tech Debt Inventory

### Phase 1: Foundation (1 item)
- Info: `.env.example` contains real Google Sheet ID instead of placeholder

### Phase 2: Scrapers (3 items)
- Warning: CSS selectors in Tier 2 scrapers are heuristic and unverified against live pages
- Warning: No post-scrape bed type audit query was ever run against the live database
- Info: LLM benchmark token cost uses estimated output JSON length

### Phase 3: Scheduler (2 items)
- Info: APScheduler 2 AM cron never confirmed via overnight wall-clock run
- Info: ROADMAP.md still shows 03-02-PLAN.md as unchecked

### Phase 4: API Layer (2 items)
- Info: Default SECRET_KEY is `change-me-in-production` (23 bytes)
- Info: `create-admin` CLI not registered as .exe script

### Phase 6: Fix Data Pipeline (2 items)
- Info: Stale docstring in `units.py` still mentions "Available Now" handling
- Warning: Runner success path duplicates `save_scrape_result` logic inline

### Phase 7: Scraper Cleanup (1 item)
- Info: `floor_plan_url` stored in DB but not returned by `/units` API

**Total: 11 tech debt items across 6 phases (0 blockers, 3 warnings, 8 info)**

---

_Audited: 2026-02-21_
_Auditor: Claude (audit-milestone workflow)_
